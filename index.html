<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>Peptidos</title>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
  <script src="//unpkg.com/alpinejs" defer></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
  <div class="container mx-auto pb-4">
    <h1>
      Caluladora de Peptidos
    </h1>
    <div 
      class="flex flex-col"
      x-data="{
      input: '',
      proteins: [],
      peptides: [],
      output: [],
      reset() {
        this.proteins = [];
        this.peptides = [];
      },
      calculateProteinsAndPeptides() {
        this.reset();
        function splitString(str, separator) {
          const arrayOfStrings = [];
          let strAccumulator = '';
          for (let i = 0; i < str.length; i++) {
            strAccumulator += str[i];
            if (str[i] === separator) {
              arrayOfStrings.push(strAccumulator);
              strAccumulator = '';
            }
          }
          if (strAccumulator !== '') {
            arrayOfStrings.push(strAccumulator);
          }
          return arrayOfStrings;
        }
        let chains = splitString(this.input, 'R');
        console.log(chains);
        chains.forEach((chain, index) => {
          const entry = chain;
          if(chain.length > 99) {
            this.output.push({chain, type: 'protein'}); 
            this.proteins.push(entry);
          }
          else{
            this.output.push({chain, type: 'peptide'});
            this.peptides.push(entry);
          }
        })
      }
    }">
      <!-- input type textarea -->
      <label for="input" class="block text-sm font-medium text-gray-700 pb-2">Ingrese la cadena</label>
      <textarea id="input"
        class="w-full h-64 border border-gray-300 rounded-lg shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 p-4"
        x-model="input">
      </textarea>
      <!-- textarea legth right -->
      
      <span class="text-sm font-normal text-gray-500 text-right" x-text="'longitud: ' + input.length"></span>
      <!-- button -->
      <button @click="calculateProteinsAndPeptides"
        class="px-4 py-2 mt-4 font-medium text-white bg-indigo-600 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-indigo-200">
        Calcular
      </button>
      <!-- output peptides -->
      <div class="mt-4">
        <h2 class="text-lg font-medium text-gray-900">
          Cadena 
          <div class="w-full">
            <template x-for="(chain, index) in output" :key="index">
              <span class="break-all text-xs leading-5 font-semibold border-r-4 border-gray-300 px-2"
              :class="chain.type === 'protein' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'" x-text="chain.chain">
              </span>
            </template>
          </div>
        <h2 class="text-lg font-medium text-gray-900">
          Peptidos 
          <span class="text-sm font-normal text-gray-500" x-text="peptides.length">
        </h2>
        <div class="mt-2">
          <ul class="border border-gray-200 rounded-lg divide-y divide-gray-200">
            <template x-for="(peptide, index) in peptides" :key="index">
              <li class="pl-3 pr-4 py-3 justify-between text-sm">
                <div class="w-full flex-1 mb-4">
                  <p class="break-all text-gray-900 text-sm font-medium" x-text="peptide">
                  </p>
                </div>
                <div class="w-0 flex-1 flex items-center">
                  <span>Longitud:</span>
                  <span x-text="peptide.length"></span>
                </div>
              </li>
            </template>
          </ul>
        </div>
      </div>
      <div class="mt-4">
        <h2 class="text-lg font-medium text-gray-900">
          Prote√≠nas 
          <span class="text-sm font-normal text-gray-500" x-text="proteins.length">
        </h2>
        <div class="mt-2">
          <ul class="border border-gray-200 rounded-lg divide-y divide-gray-200">
            <template x-for="(protein, index) in proteins" :key="index">
              <li class="pl-3 pr-4 py-3 justify-between text-sm">
                <div class="w-full flex-1 mb-4">
                  <p class="break-all text-gray-900 text-sm font-medium" x-text="protein">
                  </p>
                </div>
                <div class="w-0">
                  <span>Longitud:</span>
                  <p x-text="protein.length">
                  </p>
                </div>
              </li>
            </template>
          </ul>
        </div>
  </div>
</body>

</html>